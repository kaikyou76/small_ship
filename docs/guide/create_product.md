# ğŸ›’ å•†å“ï¼ˆProductsï¼‰ä½œæˆ

`backend/src/endpoints/productCreate.ts`

```ts
// backend/src/endpoints/productCreate.ts
import { Context } from "hono";
import {
  Bindings,
  ErrorResponse,
  ProductCreateResponse,
  JwtPayload,
} from "../types/types";
import { productSchema } from "../schemas/product";
import { uploadToR2 } from "../lib/storage";

export const productPostHandler = async (
  c: Context<{ Bindings: Bindings; Variables: { jwtPayload?: JwtPayload } }>
): Promise<Response> => {
  const db = c.env.DB;

  try {
    console.log("Received form data:", await c.req.formData());

    // èªè¨¼ãƒã‚§ãƒƒã‚¯
    const payload = c.get("jwtPayload");
    if (!payload || payload.role !== "admin") {
      return c.json(
        {
          error: {
            code: !payload ? "UNAUTHORIZED" : "FORBIDDEN",
            message: !payload
              ? "èªè¨¼ãŒå¿…è¦ã§ã™"
              : "å•†å“ç™»éŒ²ã«ã¯ç®¡ç†è€…æ¨©é™ãŒå¿…è¦ã§ã™",
          },
        } satisfies ErrorResponse,
        !payload ? 401 : 403
      );
    }

    const formData = await c.req.formData();

    // ãƒ•ã‚©ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿ã®å‰å‡¦ç†
    const rawFormData = {
      name: formData.get("name"),
      description: formData.get("description"),
      price: formData.get("price"),
      stock: formData.get("stock") || 0,
      category_id: formData.get("category_id"),
    };

    // ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
    const validationResult = productSchema.safeParse(rawFormData);
    if (!validationResult.success) {
      return c.json(
        {
          error: {
            code: "VALIDATION_ERROR",
            message: "å…¥åŠ›å†…å®¹ã«èª¤ã‚ŠãŒã‚ã‚Šã¾ã™",
            details: validationResult.error.flatten(),
          },
        } satisfies ErrorResponse,
        400
      );
    }

    // ç”»åƒå‡¦ç†
    const mainImageRaw = formData.get("mainImage") as string | File;
    const mainImageFile = mainImageRaw instanceof File ? mainImageRaw : null;
    const additionalImageFiles = (
      formData.getAll("additionalImages") as (string | File)[]
    ).filter((item): item is File => item instanceof File);

    if (!mainImageFile?.size) {
      return c.json(
        {
          error: {
            code: "MISSING_MAIN_IMAGE",
            message: "ãƒ¡ã‚¤ãƒ³ç”»åƒãŒå¿…é ˆã§ã™",
          },
        } satisfies ErrorResponse,
        400
      );
    }

    // R2ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
    const [mainImage, additionalImages] = await Promise.all([
      uploadToR2(c.env.R2_BUCKET, mainImageFile, c.env.R2_PUBLIC_DOMAIN, {
        folder: "products/main",
      }),
      Promise.all(
        additionalImageFiles
          .filter((file) => file.size > 0)
          .map((file) =>
            uploadToR2(c.env.R2_BUCKET, file, c.env.R2_PUBLIC_DOMAIN, {
              folder: "products/additional",
            })
          )
      ),
    ]);

    // å•†å“æƒ…å ±æŒ¿å…¥
    const productInsert = await db
      .prepare(
        `INSERT INTO products (
          name, description, price, stock, category_id,
          created_at
        ) VALUES (?, ?, ?, ?, ?, ?) RETURNING id;`
      )
      .bind(
        validationResult.data.name,
        validationResult.data.description,
        validationResult.data.price,
        validationResult.data.stock,
        validationResult.data.category_id,
        new Date().toISOString()
      )
      .first<{ id: number }>();

    // å•†å“IDã®å­˜åœ¨ãƒã‚§ãƒƒã‚¯
    if (!productInsert?.id) {
      throw new Error("å•†å“IDã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ");
    }

    // ãƒ¡ã‚¤ãƒ³ç”»åƒæŒ¿å…¥
    const mainImageInsert = await db
      .prepare(
        `INSERT INTO images (
          product_id, image_url, is_main, created_at
        ) VALUES (?, ?, ?, ?)`
      )
      .bind(productInsert.id, mainImage.url, 1, new Date().toISOString())
      .run();

    // ãƒ¡ã‚¤ãƒ³ç”»åƒæŒ¿å…¥çµæœãƒã‚§ãƒƒã‚¯
    if (!mainImageInsert.success) {
      throw new Error("ãƒ¡ã‚¤ãƒ³ç”»åƒã®ç™»éŒ²ã«å¤±æ•—ã—ã¾ã—ãŸ");
    }

    // è¿½åŠ ç”»åƒæŒ¿å…¥
    if (additionalImages.length > 0) {
      const additionalInserts = await db.batch(
        additionalImages.map((img) =>
          db
            .prepare(
              `INSERT INTO images (
                product_id, image_url, is_main, created_at
              ) VALUES (?, ?, ?, ?)`
            )
            .bind(productInsert.id, img.url, 0, new Date().toISOString())
        )
      );
      // è¿½åŠ ç”»åƒæŒ¿å…¥çµæœãƒã‚§ãƒƒã‚¯
      if (additionalInserts.some((result) => !result.success)) {
        throw new Error("è¿½åŠ ç”»åƒã®ç™»éŒ²ã«å¤±æ•—ã—ã¾ã—ãŸ");
      }
    }

    // ãƒ‡ãƒãƒƒã‚°ãƒ­ã‚°
    console.log("Main Image Upload Result:", {
      url: mainImage.url,
      size: mainImageFile?.size,
      type: mainImageFile?.type,
      folder: "products/main",
    });
    console.log(
      "Additional Images Upload Results:",
      additionalImages.map((img, index) => ({
        url: img.url,
        size: additionalImageFiles[index]?.size,
        type: additionalImageFiles[index]?.type,
        folder: "products/additional",
      }))
    );

    // ãƒ¬ã‚¹ãƒãƒ³ã‚¹
    return c.json(
      {
        success: true,
        data: {
          id: productInsert.id,
          name: validationResult.data.name,
          price: validationResult.data.price,
          stock: validationResult.data.stock,
          images: {
            main: {
              url: mainImage.url,
              is_main: true,
              uploaded_at: new Date().toISOString(),
            },
            additional: additionalImages.map((img) => ({
              url: img.url,
              is_main: false,
              uploaded_at: new Date().toISOString(),
            })),
          },
          createdAt: new Date().toISOString(),
        },
      } satisfies ProductCreateResponse,
      201
    );
  } catch (error) {
    console.error("Error:", error);
    return c.json(
      {
        error: {
          code: "INTERNAL_ERROR",
          message:
            error instanceof Error ? error.message : "å‡¦ç†ã«å¤±æ•—ã—ã¾ã—ãŸ",
        },
      } satisfies ErrorResponse,
      500
    );
  }
};
```

## å•†å“ä½œæˆæˆåŠŸå¾Œã®ãƒ‡ãƒãƒƒã‚¯ãƒ­ã‚°

```
â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
PS D:\next-projects\kaikyou-shop\backend> npx wrangler tail --env production
â–² [WARNING] Processing wrangler.jsonc configuration:


    - "env.production" environment configuration
      - There is a kv_namespaces binding with name "TEST_NAMESPACE" at the top level, but not on
  "env.production".
        This is not what you probably want, since "kv_namespaces" configuration is not inherited by
  environments.
        Please add a binding for "TEST_NAMESPACE" to "env.production.kv_namespaces.bindings".



 â›…ï¸ wrangler 4.15.0 (update available 4.16.0)
-------------------------------------------------------

Successfully created tail, expires at 2025-05-21T14:25:14Z
Connected to backend-production, waiting for logs...
POST https://backend-production.kai-kyou.workers.dev/api/products - Ok @ 2025/5/21 17:26:29
  (log) {"timestamp":"2025-05-21T08:26:29.715Z","method":"POST","path":"/api/products","normalizedPath":"/api/products","ip":"2400:2411:8903:1500:3817:5f1c:5398:4895","phase":"request-start","environment":"production"}
  (log) [2025-05-21T08:26:29.715Z] [JWT] ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢é–‹å§‹ {
  "requestId": "igyb0e",
  "method": "POST",
  "path": "/api/products",
  "env": "production"
}
  (log) [2025-05-21T08:26:29.715Z] [JWT] èªè¨¼ãƒ˜ãƒƒãƒ€ãƒ¼ç¢ºèª {
  "header": "Bearer v1:..."
}
  (log) [2025-05-21T08:26:29.715Z] [JWT] ãƒˆãƒ¼ã‚¯ãƒ³æ­£è¦åŒ–å®Œäº† {
  "original": "v1:eyJhbGc...7BHIwHewjA",
  "normalized": "eyJhbGciOi...7BHIwHewjA"
}
  (log) [2025-05-21T08:26:29.715Z] [JWT] ãƒˆãƒ¼ã‚¯ãƒ³æ¤œè¨¼é–‹å§‹ {
  "requestId": "igyb0e",
  "method": "POST",
  "path": "/api/products",
  "env": "production"
}
  (log) [2025-05-21T08:26:29.715Z] [JWT] èªè¨¼æˆåŠŸ {
  "user_id": 5,
  "type": "number"
}
  (log) Received form data: [object FormData]
  (log) Main Image Upload Result: {
  url: 'https://pub-1713e92651fc463cba099b34f8bf5cb1.r2.dev/products/main/yn003ey3gw2qvesfnmb4bg3l.jpg',
  size: 576216,
  type: 'image/jpeg',
  folder: 'products/main'
}
  (log) Additional Images Upload Results: [
  {
    url: 'https://pub-1713e92651fc463cba099b34f8bf5cb1.r2.dev/products/additional/bgaqg7jp4y5v394v6yta0ea9.jpg',
    size: 69276,
    type: 'image/jpeg',
    folder: 'products/additional'
  },
  {
    url: 'https://pub-1713e92651fc463cba099b34f8bf5cb1.r2.dev/products/additional/cue08l08vz1s29don6yqxjdo.jpg',
    size: 87553,
    type: 'image/jpeg',
    folder: 'products/additional'
  },
  {
    url: 'https://pub-1713e92651fc463cba099b34f8bf5cb1.r2.dev/products/additional/ikpgh37zmki2olhuurj6mfeo.jpg',
    size: 45087,
    type: 'image/jpeg',
    folder: 'products/additional'
  }
]
  (log) [2025-05-21T08:26:32.074Z] [JWT] ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢å®Œäº† {
  "requestId": "igyb0e",
  "method": "POST",
  "path": "/api/products",
  "env": "production"
}

```

## å•†å“ä½œæˆæˆåŠŸå¾Œã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹

![alt text](image-42.png)

## ä½œæˆå¾Œã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ç¢ºèª

```
PS D:\next-projects\kaikyou-shop\backend> npx wrangler d1 execute shopping-db --remote --command="select * from products";

 â›…ï¸ wrangler 4.15.0 (update available 4.16.0)
-------------------------------------------------------

ğŸŒ€ Executing on preview database shopping-db (d53ad56f-f646-44dc-8dbf-3d2d15d76973):
ğŸŒ€ To execute on your local development database, remove the --remote flag from your wrangler command.
ğŸš£ Executed 1 command in 0.3456ms
â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ id â”‚ name                 â”‚ description                                                                                                            â”‚ price   â”‚ stock â”‚ category_id â”‚ created_at               â”‚
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1  â”‚ Laptop               â”‚ A powerful laptop with 16GB RAM and 512GB SSD                                                                          â”‚ 1200    â”‚ 200   â”‚ 1           â”‚ 2025-05-05 00:49:22      â”‚
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 2  â”‚ Smartphone           â”‚ Latest model smartphone with 5G support                                                                                â”‚ 800     â”‚ 0     â”‚ 2           â”‚ 2025-05-05 00:49:22      â”‚
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 3  â”‚ Wireless Mouse       â”‚ Ergonomic wireless mouse with Bluetooth                                                                                â”‚ 30      â”‚ 78    â”‚ 3           â”‚ 2025-05-05 00:49:22      â”‚
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 4  â”‚ ãƒ¡ãƒ³ã‚ºãƒ‡ãƒ‹ãƒ ã‚¸ãƒ¼ãƒ³ã‚º â”‚ ã‚¯ãƒ©ã‚·ãƒƒã‚¯ãªãƒ‡ãƒ‹ãƒ ã‚¸ãƒ¼ãƒ³ã‚ºã€‚å¿«é©ãªå±¥ãå¿ƒåœ°ã€‚                                                                           â”‚ 8900    â”‚ 50    â”‚ 21          â”‚ 2025-05-19 09:13:10      â”‚
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 5  â”‚ ãƒãƒ©ã®èŠ±æŸ           â”‚ èµ¤ã„ãƒãƒ©10æœ¬å…¥ã‚Šã®è±ªè¯ãªèŠ±æŸã€‚                                                                                         â”‚ 5500    â”‚ 20    â”‚ 11          â”‚ 2025-05-19 09:13:10      â”‚
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 6  â”‚ æœ‰æ©Ÿé‡èœã‚»ãƒƒãƒˆ       â”‚ æ—¬ã®æœ‰æ©Ÿé‡èœãŒ5ç¨®é¡å…¥ã£ãŸã‚»ãƒƒãƒˆã€‚                                                                                      â”‚ 3200    â”‚ 30    â”‚ 23          â”‚ 2025-05-19 09:13:10      â”‚
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 7  â”‚ ã‚³ãƒ³ãƒ‘ã‚¯ãƒˆSUV        â”‚ ç‡ƒè²»ã®è‰¯ã„ã‚³ãƒ³ãƒ‘ã‚¯ãƒˆSUVã€‚æœ€æ–°å®‰å…¨è£…å‚™æ­è¼‰ã€‚                                                                            â”‚ 2980000 â”‚ 5     â”‚ 18          â”‚ 2025-05-19 09:13:10      â”‚
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 11 â”‚ é’æ£®çœŒç”£ã‚Šã‚“ã”       â”‚ ã‚¯ãƒ¼ãƒ«ä¾¿ é«˜ç³–åº¦ å…‰ã‚»ãƒ³ã‚µãƒ¼é¸æœ ã‚Šã‚“ã” 2kg é’æ£®çœŒç”£ è¦æ ¼å¤– æœ‰è¢‹ãµã˜ ãµã˜ 2kg 5kg 10kg å¯ºç”°              â”‚ 230     â”‚ 78    â”‚ null        â”‚ 2025-05-21T08:26:31.084Z â”‚
                                                                                                                       â”‚         â”‚       â”‚             â”‚                          â”‚
                                                                 â”‚         â”‚       â”‚             â”‚                          â”‚
                                                                         â”‚         â”‚       â”‚             â”‚                          â”‚
â”‚    â”‚                      â”‚ å¯†ã€ç³–åº¦ã®ä¿è¨¼ã¯ç¾åœ¨è¡Œã£ã¦ãŠã‚Šã¾ã›ã‚“ãŒã€è‰²ã€å¤§ãã•ã€å†…éƒ¨ã®è…ã‚Šã‚’é™¤å¤–ã—ã€å®‰å¿ƒå®‰å…¨ã®ã‚Šã‚“ã”ã‚’               â”‚         â”‚       â”‚             â”‚                          â”‚
                                                          â”‚         â”‚       â”‚             â”‚                          â”‚
                                                                                                                       â”‚         â”‚       â”‚             â”‚                          â”‚
â”‚    â”‚                      â”‚ ã“ã¡ã‚‰ã®ãƒªãƒ³ã‚´ãŒä¸€ã¨ã¦ã‚‚ç¾å‘³ã—ã„ã§ã™ã€‚å€¤æ®µã‚‚ãŠæ‰‹é ƒã§ã€å‚·ã‚„å‚·ã¿ã‚‚ãªãã€å¤§ãã•ã‚‚æƒã£ã¦ã„ã¾ã™ã€‚ãœã²è³¼å…¥ã—ã¦ã¿ã¦ãã ã•ã„ï¼ â”‚         â”‚       â”‚             â”‚                          â”‚
â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
PS D:\next-projects\kaikyou-shop\backend>
```

---

```
PS D:\next-projects\kaikyou-shop\backend> npx wrangler d1 execute shopping-db --remote --command="select * from images";

 â›…ï¸ wrangler 4.15.0 (update available 4.16.0)
-------------------------------------------------------

ğŸŒ€ Executing on preview database shopping-db (d53ad56f-f646-44dc-8dbf-3d2d15d76973):
ğŸŒ€ To execute on your local development database, remove the --remote flag from your wrangler command.
ğŸš£ Executed 1 command in 0.326ms
â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ id â”‚ product_id â”‚ image_url                                                                                            â”‚ alt_text             â”‚ is_main â”‚ created_at               â”‚
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1  â”‚ 1          â”‚ https://example.com/images/laptop.jpg                                                                â”‚ null                 â”‚ 0       â”‚ 2025-05-05 00:49:22      â”‚
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 2  â”‚ 2          â”‚ https://example.com/images/smartphone.jpg                                                            â”‚ null                 â”‚ 0       â”‚ 2025-05-05 00:49:22      â”‚
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 3  â”‚ 3          â”‚ https://example.com/images/mouse.jpg                                                                 â”‚ null                 â”‚ 0       â”‚ 2025-05-05 00:49:22      â”‚
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 4  â”‚ 4          â”‚ https://example.com/images/jeans1.jpg                                                                â”‚ ãƒ‡ãƒ‹ãƒ ã‚¸ãƒ¼ãƒ³ã‚ºã®ç”»åƒ â”‚ 1       â”‚ 2025-05-19 09:13:10      â”‚
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 5  â”‚ 5          â”‚ https://example.com/images/rose_bouquet.jpg                                                          â”‚ ãƒãƒ©ã®èŠ±æŸã®ç”»åƒ     â”‚ 1       â”‚ 2025-05-19 09:13:10      â”‚
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 6  â”‚ 6          â”‚ https://example.com/images/vegetable_set.jpg                                                         â”‚ æœ‰æ©Ÿé‡èœã‚»ãƒƒãƒˆã®ç”»åƒ â”‚ 1       â”‚ 2025-05-19 09:13:10      â”‚
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 7  â”‚ 7          â”‚ https://example.com/images/suv_car.jpg                                                               â”‚ SUVã®ç”»åƒ            â”‚ 1       â”‚ 2025-05-19 09:13:10      â”‚
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 14 â”‚ 11         â”‚ https://pub-1713e92651fc463cba099b34f8bf5cb1.r2.dev/products/main/yn003ey3gw2qvesfnmb4bg3l.jpg       â”‚ null                 â”‚ 1       â”‚ 2025-05-21T08:26:31.785Z â”‚
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 15 â”‚ 11         â”‚ https://pub-1713e92651fc463cba099b34f8bf5cb1.r2.dev/products/additional/bgaqg7jp4y5v394v6yta0ea9.jpg â”‚ null                 â”‚ 0       â”‚ 2025-05-21T08:26:31.927Z â”‚
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 16 â”‚ 11         â”‚ https://pub-1713e92651fc463cba099b34f8bf5cb1.r2.dev/products/additional/cue08l08vz1s29don6yqxjdo.jpg â”‚ null                 â”‚ 0       â”‚ 2025-05-21T08:26:31.927Z â”‚
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 17 â”‚ 11         â”‚ https://pub-1713e92651fc463cba099b34f8bf5cb1.r2.dev/products/additional/ikpgh37zmki2olhuurj6mfeo.jpg â”‚ null                 â”‚ 0       â”‚ 2025-05-21T08:26:31.927Z â”‚
â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
PS D:\next-projects\kaikyou-shop\backend>
```

## å•†å“ç”»åƒã‚’è¡¨ç¤ºã™ã‚‹ã®ã«ã„ãã¤ã‹ã®ç…©é›‘ãªè¨­å®šãŒå¿…è¦ã¨ãªã‚Šã¾ã™ã€‚

- â‘ R2CORS ãƒãƒªã‚·ãƒ¼ã®è¨­å®š
  `https://dash.cloudflare.com/`ã«ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ CORS ãƒãƒªã‚·ãƒ¼ã‚’è¨­å®šã—ã¾ã™ã€‚

```
[
  {
    "AllowedOrigins": [
      "https://kaikyou-online-shop.onrender.com",
      "https://kaikyou-online-shop.vercel.app",
      "http://localhost:3000"
    ],
    "AllowedMethods": [
      "GET",
      "POST",
      "PUT",
      "DELETE",
      "HEAD"
    ],
    "AllowedHeaders": [
      "Authorization",
      "Content-Type"
    ]
  }
]
```

- â‘¡R2_PUBLIC_DOMAIN ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®šã—ã¾ã™ã€‚
  `frontend/.env.production`

  ```bash
  NEXT_PUBLIC_R2_PUBLIC_DOMAIN=pub-1713e92651fc463cba099b34f8bf5cb1.r2.dev
  ```

- â‘¢next.config.mjs ã§ R2_PUBLIC_DOMAIN ã‚’æ‰¿èªã™ã‚‹

  `frontend/next.config.mjs`

```js
const isProduction = process.env.NODE_ENV === "production";

const nextConfig = {
  images: {
    domains: ["pub-1713e92651fc463cba099b34f8bf5cb1.r2.dev"],
    remotePatterns:
      isProduction && process.env.NEXT_PUBLIC_R2_PUBLIC_DOMAIN
        ? [
            {
              protocol: "https",
              hostname: process.env.NEXT_PUBLIC_R2_PUBLIC_DOMAIN.replace(
                /^https?:\/\//,
                ""
              ),
              pathname: "/products/**",
            },
          ]
        : [],
  },
};

export default nextConfig;
```
